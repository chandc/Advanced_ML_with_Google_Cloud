<!DOCTYPE html>
<!-- saved from url=(0049)https://googlecoursera.qwiklabs.com/focuses/35232 -->
<html lang="en" class="gr__googlecoursera_qwiklabs_com mdl-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/caff0d62ed"></script><script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/nr-1158.min.js"></script><script type="text/javascript" async="" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/js"></script><script type="text/javascript" async="" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/analytics.js"></script><script type="text/javascript" async="" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/d58fn3dh7i2n.js"></script><script type="text/javascript" async="" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/analytics.min.js"></script><script type="text/javascript" id="www-widgetapi-script" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/www-widgetapi.js" async=""></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"caff0d62ed","applicationID":"29451451","transactionName":"IQ1XRUEOVV1dFxlRXAEXSlRATkpZVxI=","queueTime":0,"applicationTime":180,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).loader_config={licenseKey:"caff0d62ed",applicationID:"29451451"};window.NREUM||(NREUM={}),__nr_require=function(n,e,t){function r(t){if(!e[t]){var i=e[t]={exports:{}};n[t][0].call(i.exports,function(e){var i=n[t][1][e];return r(i||e)},i,i.exports)}return e[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<t.length;i++)r(t[i]);return r}({1:[function(n,e,t){function r(){}function i(n,e,t){return function(){return o(n,[u.now()].concat(f(arguments)),e?null:this,t),e?void 0:this}}var o=n("handle"),a=n(4),f=n(5),c=n("ee").get("tracer"),u=n("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(n,e){s[e]=i(d+e,!0,"api")}),s.addPageAction=i(d+"addPageAction",!0),s.setCurrentRouteName=i(d+"routeName",!0),e.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(n,e){var t={},r=this,i="function"==typeof e;return o(l+"tracer",[u.now(),n,t],r),function(){if(c.emit((i?"":"no-")+"fn-start",[u.now(),r,i],t),i)try{return e.apply(this,arguments)}catch(n){throw c.emit("fn-err",[arguments,this,n],t),n}finally{c.emit("fn-end",[u.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(n,e){m[e]=i(l+e)}),newrelic.noticeError=function(n,e){"string"==typeof n&&(n=new Error(n)),o("err",[n,u.now(),!1,e])}},{}],2:[function(n,e,t){function r(n,e){var t=n.getEntries();t.forEach(function(n){"first-paint"===n.name?a("timing",["fp",Math.floor(n.startTime)]):"first-contentful-paint"===n.name&&a("timing",["fcp",Math.floor(n.startTime)])})}function i(n){if(n instanceof c&&!s){var e,t=Math.round(n.timeStamp);e=t>1e12?Date.now()-t:f.now()-t,s=!0,a("timing",["fi",t,{type:n.type,fid:e}])}}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var o,a=n("handle"),f=n("loader"),c=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){o=new PerformanceObserver(r);try{o.observe({entryTypes:["paint"]})}catch(u){}}if("addEventListener"in document){var s=!1,p=["click","keydown","mousedown","pointerdown","touchstart"];p.forEach(function(n){document.addEventListener(n,i,!1)})}}},{}],3:[function(n,e,t){function r(n,e){if(!i)return!1;if(n!==i)return!1;if(!e)return!0;if(!o)return!1;for(var t=o.split("."),r=e.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var f=navigator.userAgent,c=f.match(a);c&&f.indexOf("Chrome")===-1&&f.indexOf("Chromium")===-1&&(i="Safari",o=c[1])}e.exports={agent:i,version:o,match:r}},{}],4:[function(n,e,t){function r(n,e){var t=[],r="",o=0;for(r in n)i.call(n,r)&&(t[o]=e(r,n[r]),o+=1);return t}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],5:[function(n,e,t){function r(n,e,t){e||(e=0),"undefined"==typeof t&&(t=n?n.length:0);for(var r=-1,i=t-e||0,o=Array(i<0?0:i);++r<i;)o[r]=n[e+r];return o}e.exports=r},{}],6:[function(n,e,t){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(n,e,t){function r(){}function i(n){function e(n){return n&&n instanceof r?n:n?c(n,f,o):o()}function t(t,r,i,o){if(!d.aborted||o){n&&n(t,r,i);for(var a=e(i),f=v(t),c=f.length,u=0;u<c;u++)f[u].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(n,e){h[n]=v(n).concat(e)}function m(n,e){var t=h[n];if(t)for(var r=0;r<t.length;r++)t[r]===e&&t.splice(r,1)}function v(n){return h[n]||[]}function g(n){return p[n]=p[n]||i(t)}function w(n,e){u(n,function(n,t){e=e||"feature",y[t]=e,e in s||(s[e]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:e,buffer:w,abort:a,aborted:!1};return b}function o(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var f="nr@context",c=n("gos"),u=n(4),s={},p={},d=e.exports=i();d.backlog=s},{}],gos:[function(n,e,t){function r(n,e,t){if(i.call(n,e))return n[e];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(n,e,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return n[e]=r,r}var i=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(n,e,t){function r(n,e,t,r){i.buffer([n],r),i.emit(n,e,t)}var i=n("ee").get("handle");e.exports=r,r.ee=i},{}],id:[function(n,e,t){function r(n){var e=typeof n;return!n||"object"!==e&&"function"!==e?-1:n===window?0:a(n,o,function(){return i++})}var i=1,o="nr@id",a=n("gos");e.exports=r},{}],loader:[function(n,e,t){function r(){if(!x++){var n=E.info=NREUM.info,e=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(n&&n.licenseKey&&n.applicationID&&e))return s.abort();u(y,function(e,t){n[e]||(n[e]=t)}),c("mark",["onload",a()+E.offset],null,"api");var t=l.createElement("script");t.src="https://"+n.agent,e.parentNode.insertBefore(t,e)}}function i(){"complete"===l.readyState&&o()}function o(){c("mark",["domContent",a()+E.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(f=Math.max((new Date).getTime(),f))-E.offset}var f=(new Date).getTime(),c=n("handle"),u=n(4),s=n("ee"),p=n(3),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1158.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),E=e.exports={offset:f,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};n(1),n(2),l[m]?(l[m]("DOMContentLoaded",o,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",i),d[v]("onload",r)),c("mark",["firstbyte",f],null,"api");var x=0,O=n(6)},{}],"wrap-function":[function(n,e,t){function r(n){return!(n&&n instanceof Function&&n.apply&&!n[a])}var i=n("ee"),o=n(5),a="nr@original",f=Object.prototype.hasOwnProperty,c=!1;e.exports=function(n,e){function t(n,e,t,i){function nrWrapper(){var r,a,f,c;try{a=this,r=o(arguments),f="function"==typeof t?t(r,a):t||{}}catch(u){d([u,"",[r,a,i],f])}s(e+"start",[r,a,i],f);try{return c=n.apply(a,r)}catch(p){throw s(e+"err",[r,a,p],f),p}finally{s(e+"end",[r,a,c],f)}}return r(n)?n:(e||(e=""),nrWrapper[a]=n,p(n,nrWrapper),nrWrapper)}function u(n,e,i,o){i||(i="");var a,f,c,u="-"===i.charAt(0);for(c=0;c<e.length;c++)f=e[c],a=n[f],r(a)||(n[f]=t(a,u?f+i:i,o,f))}function s(t,r,i){if(!c||e){var o=c;c=!0;try{n.emit(t,r,i,e)}catch(a){d([a,t,r,i])}c=o}}function p(n,e){if(Object.defineProperty&&Object.keys)try{var t=Object.keys(n);return t.forEach(function(t){Object.defineProperty(e,t,{get:function(){return n[t]},set:function(e){return n[t]=e,e}})}),e}catch(r){d([r])}for(var i in n)f.call(n,i)&&(e[i]=n[i]);return e}function d(e){try{n.emit("internal-error",e)}catch(t){}}return n||(n=i),t.inPlace=u,t.flag=a,t}},{}]},{},["loader"]);</script>
<meta content="[]" name="active-experiments">
<meta content="{&quot;userId&quot;:1344779}" name="help-api-product-data">
<meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="h+eaUulUHVAFG/UWauTW50APU55ciugnQOYpnz9NyaK4pW4bRz8prKN5AhKPYHww6XmX64rnXDDwCLz+NXLkXQ==">
<title>Image Classification Transfer Learning with Inception v3 | Qwiklabs</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0" name="viewport">
<meta content="In this lab, you carry out a transfer learning example based on Inception-v3 image recognition neural network. " name="description">
<meta content="Qwiklabs" name="author">
<meta content="1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0" name="google-site-verification">
<meta content="Image Classification Transfer Learning with Inception v3 | Qwiklabs" property="og:title">
<meta content="website" property="og:type">
<meta content="/favicon-144.png" property="og:image">
<meta content="Qwiklabs" property="og:site_name">
<meta content="In this lab, you carry out a transfer learning example based on Inception-v3 image recognition neural network. " property="og:description">
<meta content="/qwiklabs_logo_900x887.png" property="og:logo" size="900x887">
<meta content="/qwiklabs_logo_994x187.png" property="og:logo" size="994x187">
<meta content="#3681E4" property="msapplication-TileColor">
<meta content="/favicon-144.png" property="msapplication-TileImage">
<link href="https://googlecoursera.qwiklabs.com/favicon-32.png" rel="shortcut icon">
<link color="#3681E4" href="https://googlecoursera.qwiklabs.com/favicon-svg.svg" rel="mask-icon">
<link href="https://googlecoursera.qwiklabs.com/favicon-180.png" rel="apple-touch-icon-precomposed">
<link rel="stylesheet" media="screen" href="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/css">


<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"Daniel","lastname":"Chan","fullname":"Daniel Chan","company":"Login with Google","email":"chandc999@gmail.com","origin":"amazon-run, direct","subscriptions":0,"id":"d989509dbf51eb7158586571712a33e2","qlCreatedAt":"2019-01-02 01:19:30 UTC","optIn":null};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="googlecoursera-run";
//]]>
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id="ze-snippet" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/snippet.js"></script><script type="text/javascript" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/asset_composer.5d2cd6d9613b85125812.js" charset="utf-8" async=""></script>



<link rel="stylesheet" media="all" href="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/application-a53cf05bc9e39a99a1d6fa14f486d7ecec091bb67f0aca5b1257120cbf85ec76.css">
<script>
  EVENT_SOURCE_BASE_URL = "https://googlecoursera-run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/webcomponents-loader.js"></script>
<script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/hallofmirrors-f4d8e7baa61f870f42fe13c7adb947f8f436226a8699d6dc2443699a02a10471.js"></script><script async="" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/lazy.min.js"></script>
<script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/iframe_api"></script>
<script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js"></script>
<script src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/application-ebb27cbff944188da04b9e68f7789655da6ebaa697498ca84f00351368bd2507.js"></script>
</head>
<body class="focuses focuses-show lab-show l-full no-nav" data-gr-c-s-loaded="true">
<div class="header-container">
<div class="header">
<a class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect header__button header__button--nav header__nav-panel-button js-nav-toggle" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">menu</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header__title">
<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button header__button--nav" href="https://www.coursera.org/" data-upgraded=",MaterialButton,MaterialRipple"><ql-icon>arrow_back</ql-icon><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>

<h1 class="headline-5">
Image Classification Transfer Learning with Inception v3
</h1>
</div>
<div class="header__actions">
<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button header__button--action header__button--search js-header-search-bar-button" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">search</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>

<ql-help context="lab" productdata="{&quot;userId&quot;:1344779}" data-analytics-action="opened_help" data-analytics-label="lab"></ql-help>
<a class="header-my-account-button mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect js-my-account-button" data-upgraded=",MaterialButton,MaterialRipple">
<img class="avatar " src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/8f4433a25a5cde294484102cb6d5a3db.png">
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header-my-account-menu js-my-account-menu">
<div class="card elevation-2 no-padding">
<div class="my-account-menu__top">
<img class="avatar " src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/8f4433a25a5cde294484102cb6d5a3db.png">
<div class="my-account-menu__info">
<h4 class="subtitle-headline-1">
Daniel Chan
</h4>
<p class="body-2 text--gray">
<span>chandc999@gmail.com</span>
</p>
<a class="button" href="https://googlecoursera.qwiklabs.com/my_account/profile">My Account</a>
</div>
</div>
<div class="my-account-menu__bottom">
<a class="text--green subtitle-headline-2" href="https://googlecoursera.qwiklabs.com/my_account/credits">0 Credits
</a><a data-analytics-action="clicked_sign_out" class="button button--hairline" rel="nofollow" data-method="delete" href="https://googlecoursera.qwiklabs.com/users/sign_out">Sign Out</a>
</div>
</div>
</div>

</div>
</div>
<div class="header__search-bar js-header-search-bar">
<form id="catalog-search-mobile" onsubmit="ql.catalogSearchFilter(); return false;" action="https://googlecoursera.qwiklabs.com/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="âœ“"><input type="hidden" name="authenticity_token" value="h+eaUulUHVAFG/UWauTW50APU55ciugnQOYpnz9NyaK4pW4bRz8prKN5AhKPYHww6XmX64rnXDDwCLz+NXLkXQ==">
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255">
</form>

<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">close</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
</div>
</div>

<nav class="nav-bar">
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-bar__item__icon">
home
</ql-icon>
<span class="nav-bar__item__label">
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-bar__item__icon">
school
</ql-icon>
<span class="nav-bar__item__label">
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-bar__item__icon">
event_note
</ql-icon>
<span class="nav-bar__item__label">
My Learning
</span>
</a>
</nav>

<nav class="nav-panel js-nav-panel">
<div class="nav-panel__logo">
<div class="logo logo--blue"></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-panel__item__icon">
home
</ql-icon>
<div class="nav-panel__item__label">
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-panel__item__icon">
school
</ql-icon>
<div class="nav-panel__item__label">
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-panel__item__icon">
event_note
</ql-icon>
<div class="nav-panel__item__label">
My Learning
</div>
</a>
<div class="nav-panel__spacer"></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/profile"><ql-icon class="nav-panel__item__icon">
account_circle
</ql-icon>
<div class="nav-panel__item__label">
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/credits"><ql-icon class="nav-panel__item__icon">
money
</ql-icon>
<div class="nav-panel__item__label">
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/security"><ql-icon class="nav-panel__item__icon">
security
</ql-icon>
<div class="nav-panel__item__label">
Security
</div>
</a>
<div class="nav-panel__spacer"></div>
<a class="nav-panel__item" tabindex="-1" href="https://googlecoursera.qwiklabs.com/focuses/35232#"><ql-help>
<div class="nav-panel__help-item">
<ql-icon class="nav-panel__item__icon">help</ql-icon>
<div class="nav-panel__item__label">Help</div>
</div>
</ql-help>
</a><div class="nav-panel__small-links">
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/privacy_policy">Privacy</a>
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/terms_of_service">Terms</a>
</div>
</nav>
<div class="nav-panel__overlay js-nav-toggle"></div>

<main class="js-main">
<span class="hidden" id="flash-sibling-before"></span>

<div class="l-main-wrapper" id="main-wrapper">







<div class="js-lab-state" data-analytics-payload="{&quot;label&quot;:&quot;Image Classification Transfer Learning with Inception v3&quot;,&quot;lab_name&quot;:&quot;Image Classification Transfer Learning with Inception v3&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;googlecoursera-run&quot;}" data-focus-id="35232" data-lab-billing-limit="0.0" data-lab-duration="7200" data-parent="classroom"></div>
<ql-lab-control-panel class="js-lab-control-panel l-lab-control-panel" connectiondetails="[]" connectionfiles="[]" labcontrolbutton="{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}" labtimer="{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:7200}" studentresources="[]"></ql-lab-control-panel>
<div class="l-lab-main-body">
<div class="js-lab-content lab-content">
<div class="alert alert--fake js-alert">
<p class="alert__message js-alert-message"></p>
<a class="alert__close js-alert-close">
<i class="fa fa-times"></i>
</a>
<iframe class="l-ie-iframe-fix" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource.html"></iframe>
</div>
<div class="lab-content__markdown-wrapper">
<div class="lab-preamble">
<h1 class="lab-preamble__title">
Image Classification Transfer Learning with Inception v3
</h1>
<div class="lab-preamble__details subtitle-headline-1">
<span>2 hours </span>
<span>Free</span>
<div class="lab__rating">
<a href="https://googlecoursera.qwiklabs.com/focuses/35232/reviews?parent=catalog"><div class="rateit" data-rateit-readonly="true" data-rateit-value="3.7123"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 59.3968px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>

</a><a data-target="#lab-review-modal" data-toggle="modal">
Rate Lab
</a>
</div>
</div>
</div>

<div class="lab-content__inner-wrapper">
<div class="js-markdown-instructions lab-content__markdown markdown-lab-instructions" id="markdown-lab-instructions">



<h2 id="step1">Overview</h2>
<p>In this lab, you carry out a transfer learning example based on Inception-v3 image recognition neural network.</p>
<h3><strong>What you learn</strong></h3>
<ul>
<li>
<p>How a transfer learning works</p>
</li>
<li>
<p>How to use Cloud Dataflow for a batch processing of image data</p>
</li>
<li>
<p>How to use Cloud AI Platform to train a classification model</p>
</li>
<li>
<p>How to use Cloud AI Platform to provide a prediction API service</p>
</li>
</ul>
<h2 id="step2">Introduction</h2>
<p><em>Duration is 2 min</em></p>
<p>Transfer learning is a machine learning method which utilizes a pre-trained neural network. For example, the image recognition model called  <a href="https://arxiv.org/abs/1512.00567">Inception-v3</a> consists of two parts:</p>
<ul>
<li>Feature extraction part with a convolutional neural network.</li>
<li>Classification part with fully-connected and softmax layers.</li>
</ul>
<p>The pre-trained Inception-v3 model achieves state-of-the-art accuracy for recognizing general objects with 1000 classes, like "Zebra", "Dalmatian", and "Dishwasher". The model extracts general features from input images in the first part and classifies them based on those features in the second part.</p>
<p><img alt="bfea25ba557fbffc.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/5+CPi8dlPWOjPRTPyK_vIFLA6DI+7YLHt2wM0r4X1Mg="></p>
<p>In transfer learning, when you build a new model to classify your original dataset, you reuse the feature extraction part and re-train the classification part with your dataset. Since you don't have to train the feature extraction part (which is the most complex part of the model), you can train the model with less computational resources and training time.</p>
<h2 id="step3">Setup</h2>
<p><em>Duration is 5 min</em></p>
<p>For each lab, you get a new GCP project and set of resources for a fixed time at no cost.</p>
<ol>
<li>
<p>Make sure you signed into Qwiklabs using an <strong>incognito window</strong>.</p>
</li>
<li>
<p>Note the lab's access time (for example, <img alt="img/time.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/aZQJ4BT7uCmM9XR6BTXgTRP1Hfu1T7q6V+cnbdEsbpU="> and make sure you can finish in that time block.</p>
</li>
</ol>
<aside> <p>
  There is no pause feature. You can restart if needed, but you have to start at the beginning.
  </p>

</aside>
<ol start="3">
<li>
<p>When ready, click <img alt="img/start_lab.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/XE8x7uvQokyubNwnYKKc+vBBNrMlo5iNZiDDzQQ3Ddo=">.</p>
</li>
<li>
<p>Note your lab credentials. You will use them to sign in to Cloud Platform Console.
<img alt="img/open_google_console.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/0d78dhX6IVMVWmixCPPSBbmi5O2GPokCXf1Ps1AkTgI="></p>
</li>
<li>
<p>Click <strong>Open Google Console</strong>.</p>
</li>
<li>
<p>Click <strong>Use another account</strong> and copy/paste credentials for <strong>this</strong> lab into the prompts.</p>
</li>
</ol>
<aside class="warning"><p>
  If you use other credentials, you'll get errors or <strong>incur charges</strong>.
  </p>
</aside>
<ol start="7">
<li>Accept the terms and skip the recovery resource page.</li>
</ol>
<aside class="warning"><p>
  Do not click <strong>End Lab</strong> unless you are finished with the lab or want to restart it. This clears your work and removes the project.
  </p>
</aside>

<h2 id="step4">Requirements</h2>
<h3>Step 1: Confirm that needed APIs are enable.</h3>
<p>In the GCP Console, on the <strong>Navigation menu</strong> (<img alt="mainmenu.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/QRLlvUpflhvp875q7fi7Mf_iVCqtMcM10Vfn0vwKZ+4=">), click <strong>APIs &amp; Services</strong> &gt; <strong>Library</strong>.</p>
<p>Search for the below APIs by name and click on <strong>ENABLE</strong> button if necessary.</p>
<ul>
<li>
<p>Cloud Machine Learning Engine</p>
</li>
<li>
<p>Dataflow API</p>
</li>
</ul>
<h3>Step 2: Launch CloudShell</h3>
<p>Open the <strong>cloud shell</strong>. The cloud shell icon is at the top right:</p>
<p><img alt="8206c366e1f66c6e.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/BwlrLBaqyMI6X+HwvgxAL0PiA54rL_gAGht3CT3_1J4="></p>
<p>A cloud shell session will open inside a new frame at the bottom of your browser.</p>
<p><img alt="29c891701d874b22.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/OvguI9nVl9wk0pclkP7P+AghaFLElDBGoFhNH7kJ7VQ="></p>
<h3>Step 3: Install Cloud ML SDK</h3>
<p>Install Cloud ML SDK, and modify the PATH.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">sudo pip install tensorflow</span><span class="pun">==</span><span class="lit">1.13</span><span class="pun">.</span><span class="lit">1</span><span class="pln">
sudo pip install apache</span><span class="pun">-</span><span class="pln">beam</span><span class="pun">[</span><span class="pln">gcp</span><span class="pun">]</span><span class="pln">
sudo pip install image
export PATH</span><span class="pun">=</span><span class="pln">$</span><span class="pun">{</span><span class="pln">HOME</span><span class="pun">}/.</span><span class="kwd">local</span><span class="pun">/</span><span class="pln">bin</span><span class="pun">:</span><span class="pln">$</span><span class="pun">{</span><span class="pln">PATH</span><span class="pun">}</span></code><button class="button button--copy js-copy-button-0"><i class="fa fa-clipboard"></i></button></pre>
<h3>Step 4: Download tutorial files</h3>
<p>Download tutorial files and set your current directory.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">git clone https</span><span class="pun">://</span><span class="pln">github</span><span class="pun">.</span><span class="pln">com</span><span class="pun">/</span><span class="typ">GoogleCloudPlatform</span><span class="pun">/</span><span class="pln">cloudml</span><span class="pun">-</span><span class="pln">samples
cd cloudml</span><span class="pun">-</span><span class="pln">samples</span><span class="pun">/</span><span class="pln">tensorflow</span><span class="pun">/</span><span class="pln">standard</span><span class="pun">/</span><span class="pln">legacy</span><span class="pun">/</span><span class="pln">flowers</span></code><button class="button button--copy js-copy-button-1"><i class="fa fa-clipboard"></i></button></pre>
<h2 id="step5">Learn the Dataset</h2>
<p><em>Duration is 2 min</em></p>
<p><img alt="7221191ec60f55f6.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/a9sz9MraIrnVkBXpjD2VGEuHyivTlNZggCkvcktQ6cg="></p>
<p><a href="https://www.flickr.com/photos/calliope/1008566138/">Sunflowers</a> <em>by Liz West is licensed under</em> <a href="https://creativecommons.org/licenses/by/2.0/">CC BY 2.0</a></p>
<p>You have about 3,600 flower images with five categories. The five category labels are listed in the dictionary file ( <a href="https://storage.cloud.google.com/cloud-ml-data/img/flower_photos/dict.txt">dict.txt</a>) as below:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">daisy
dandelion
roses
sunflowers
tulips</span></code><button class="button button--copy js-copy-button-2"><i class="fa fa-clipboard"></i></button></pre>
<p>This file is used to translate labels into internal ID numbers in the following processes such as daisy=0, dandelion=1, etc.</p>
<p>The images are randomly split into a training set with 90% data and an evaluation set with 10% data. Each of them are listed in CSV files:</p>
<ul>
<li>Training set:  <a href="https://storage.cloud.google.com/cloud-ml-data/img/flower_photos/train_set.csv">train_set.csv</a>
</li>
<li>Evaluation set:  <a href="https://storage.cloud.google.com/cloud-ml-data/img/flower_photos/eval_set.csv">eval_set.csv</a>
</li>
</ul>
<p>The CSV files have the following format consisting of image URIs and labels:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">dandelion</span><span class="pun">/</span><span class="lit">17388674711</span><span class="pln">_6dca8a2e8b_n</span><span class="pun">.</span><span class="pln">jpg</span><span class="pun">,</span><span class="pln">dandelion
gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">sunflowers</span><span class="pun">/</span><span class="lit">9555824387</span><span class="pln">_32b151e9b0_m</span><span class="pun">.</span><span class="pln">jpg</span><span class="pun">,</span><span class="pln">sunflowers
gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">daisy</span><span class="pun">/</span><span class="lit">14523675369</span><span class="pln">_97c31d0b5b</span><span class="pun">.</span><span class="pln">jpg</span><span class="pun">,</span><span class="pln">daisy
gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">roses</span><span class="pun">/</span><span class="lit">512578026</span><span class="pln">_f6e6f2ad26</span><span class="pun">.</span><span class="pln">jpg</span><span class="pun">,</span><span class="pln">roses
gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">tulips</span><span class="pun">/</span><span class="lit">497305666</span><span class="pln">_b5d4348826_n</span><span class="pun">.</span><span class="pln">jpg</span><span class="pun">,</span><span class="pln">tulips
</span><span class="pun">...</span></code><button class="button button--copy js-copy-button-3"><i class="fa fa-clipboard"></i></button></pre>
<p>You input these images into the feature extraction part of Inception-v3 which converts the image data into feature vectors consisting of 2048 float values for each image. A feature vector represents the features of the image in an abstract manner. You can better classify images based on these vector values rather than raw image data.</p>
<h2 id="step6">Preprocess Images with Cloud Dataflow</h2>
<p><em>Duration is 54 min</em></p>
<h3>Preprocess the Evaluation Set</h3>
<p>You use Cloud Dataflow to automate the feature extraction process. First, you do it for the evaluation dataset.</p>
<h4>Step 1</h4>
<p>Set variables to specify the output path and the dictionary file on Cloud Storage.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">DICT_FILE</span><span class="pun">=</span><span class="pln">gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">dict</span><span class="pun">.</span><span class="pln">txt
PROJECT</span><span class="pun">=</span><span class="pln">$</span><span class="pun">(</span><span class="pln">gcloud config list project </span><span class="pun">--</span><span class="pln">format </span><span class="str">"value(core.project)"</span><span class="pun">)</span><span class="pln">
BUCKET</span><span class="pun">=</span><span class="str">"gs://${PROJECT}-flower"</span><span class="pln">
GCS_PATH</span><span class="pun">=</span><span class="str">"${BUCKET}/${USER}"</span></code><button class="button button--copy js-copy-button-4"><i class="fa fa-clipboard"></i></button></pre>
<h4>Step 2</h4>
<p>Create a bucket for the output files and submit a Cloud Dataflow job to process the evaluation set.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil mb $BUCKET
python trainer</span><span class="pun">/</span><span class="pln">preprocess</span><span class="pun">.</span><span class="pln">py \
  </span><span class="pun">--</span><span class="pln">input_dict </span><span class="str">"$DICT_FILE"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">input_path </span><span class="str">"gs://cloud-ml-data/img/flower_photos/eval_set.csv"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">output_path </span><span class="str">"${GCS_PATH}/preproc/eval"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">cloud \
  </span><span class="pun">--</span><span class="pln">num_workers </span><span class="lit">5</span></code><button class="button button--copy js-copy-button-5"><i class="fa fa-clipboard"></i></button></pre>
<p>In the GCP Console, on the <strong>Navigation menu</strong> (<img alt="mainmenu.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/QRLlvUpflhvp875q7fi7Mf_iVCqtMcM10Vfn0vwKZ+4=">), click <strong>Dataflow</strong>, you find the running job and the link navigates to the data flow graph as below:</p>
<p><img alt="job_status.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/C+XLEG42DIF_jbuDE2Z9BlfsbAmJPpY7RtSYDSkPqIk="></p>
<aside class="warning"><p><strong>Note</strong>: The job takes around 10-15 minutes (depending on the environment) to finish. You can proceed with the next subsection to process the training set in parallel.</p>
</aside>
<h3>Preprocess the Training Set</h3>
<p>Since the job takes some time to finish, click <strong>+</strong> symbol to open a new tab in the cloud shell and submit another job to process the training set in parallel.</p>
<h4>Step 3</h4>
<p>Set your current directory in the new tab.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">cd $HOME</span><span class="pun">/</span><span class="pln">cloudml</span><span class="pun">-</span><span class="pln">samples</span><span class="pun">/</span><span class="pln">tensorflow</span><span class="pun">/</span><span class="pln">standard</span><span class="pun">/</span><span class="pln">legacy</span><span class="pun">/</span><span class="pln">flowers</span></code><button class="button button--copy js-copy-button-6"><i class="fa fa-clipboard"></i></button></pre>
<h4>Step 4</h4>
<p>Set variables to specify the output path and the dictionary file on Cloud Storage.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">DICT_FILE</span><span class="pun">=</span><span class="pln">gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">dict</span><span class="pun">.</span><span class="pln">txt
PROJECT</span><span class="pun">=</span><span class="pln">$</span><span class="pun">(</span><span class="pln">gcloud config list project </span><span class="pun">--</span><span class="pln">format </span><span class="str">"value(core.project)"</span><span class="pun">)</span><span class="pln">
BUCKET</span><span class="pun">=</span><span class="str">"gs://${PROJECT}-flower"</span><span class="pln">
GCS_PATH</span><span class="pun">=</span><span class="str">"${BUCKET}/${USER}"</span></code><button class="button button--copy js-copy-button-7"><i class="fa fa-clipboard"></i></button></pre>
<h4>Step 5</h4>
<p>Submit a Cloud Dataflow job to process the training set.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">python trainer</span><span class="pun">/</span><span class="pln">preprocess</span><span class="pun">.</span><span class="pln">py \
  </span><span class="pun">--</span><span class="pln">input_dict </span><span class="str">"$DICT_FILE"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">input_path </span><span class="str">"gs://cloud-ml-data/img/flower_photos/train_set.csv"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">output_path </span><span class="str">"${GCS_PATH}/preproc/train"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">cloud \
  </span><span class="pun">--</span><span class="pln">num_workers </span><span class="lit">5</span></code><button class="button button--copy js-copy-button-8"><i class="fa fa-clipboard"></i></button></pre>
<aside class="warning"><p><strong>Note</strong>: The whole process takes around 10 to 15 minutes (depending on the environment) to finish. Please wait for both jobs to finish successfully.</p>
</aside>
<h3>Confirm the Preprocessed Files</h3>
<p>When both jobs finished, the preprocessed files are stored in the following storage paths.</p>
<h4>Step 6</h4>
<p>Confirm that preprocessed files for the evaluation set are created.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil ls </span><span class="str">"${GCS_PATH}/preproc/eval*"</span></code><button class="button button--copy js-copy-button-9"><i class="fa fa-clipboard"></i></button></pre>
<p>You see the following files are stored in Cloud Storage.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="kwd">eval</span><span class="pun">-</span><span class="lit">00000</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00043.tfrecord</span><span class="pun">.</span><span class="pln">gz
gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="kwd">eval</span><span class="pun">-</span><span class="lit">00001</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00043.tfrecord</span><span class="pun">.</span><span class="pln">gz
gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="kwd">eval</span><span class="pun">-</span><span class="lit">00002</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00043.tfrecord</span><span class="pun">.</span><span class="pln">gz
</span><span class="pun">...</span></code><button class="button button--copy js-copy-button-10"><i class="fa fa-clipboard"></i></button></pre>
<h4>Step 7</h4>
<p>Confirm that preprocessed files for the training set are created.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil ls </span><span class="str">"${GCS_PATH}/preproc/train*"</span></code><button class="button button--copy js-copy-button-11"><i class="fa fa-clipboard"></i></button></pre>
<p>You see the following files are stored in Cloud Storage.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="pln">train</span><span class="pun">-</span><span class="lit">00000</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00062.tfrecord</span><span class="pun">.</span><span class="pln">gz
gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="pln">train</span><span class="pun">-</span><span class="lit">00001</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00062.tfrecord</span><span class="pun">.</span><span class="pln">gz
gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/</span><span class="pln">enakai</span><span class="pun">/</span><span class="pln">preproc</span><span class="pun">/</span><span class="pln">train</span><span class="pun">-</span><span class="lit">00002</span><span class="pun">-</span><span class="pln">of</span><span class="pun">-</span><span class="lit">00062.tfrecord</span><span class="pun">.</span><span class="pln">gz
</span><span class="pun">...</span></code><button class="button button--copy js-copy-button-12"><i class="fa fa-clipboard"></i></button></pre>
<h2 id="step7">Train the Model with Cloud AI Platform</h2>
<p><em>Duration is 15 min</em></p>
<p>The next step is to train the classification part of the model using the preprocessed data. The following diagram shows the relationship between the preprocessing and the training.</p>
<p><img alt="4a077a942db85cb3.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/RDHNC7SaeUTh52NJWlNLE7+xmk_SwfVMF9AQE2BAV7Q="></p>
<h4>Step 1</h4>
<p>Submit a Cloud ML job to train the classification part of the model:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">JOB_ID</span><span class="pun">=</span><span class="str">"flowers_${USER}_$(date +%Y%m%d_%H%M%S)"</span><span class="pln">
gcloud ai</span><span class="pun">-</span><span class="pln">platform jobs submit training </span><span class="str">"$JOB_ID"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">module</span><span class="pun">-</span><span class="pln">name trainer</span><span class="pun">.</span><span class="pln">task \
  </span><span class="pun">--</span><span class="pln">package</span><span class="pun">-</span><span class="pln">path trainer \
  </span><span class="pun">--</span><span class="pln">staging</span><span class="pun">-</span><span class="pln">bucket </span><span class="str">"$BUCKET"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">region us</span><span class="pun">-</span><span class="pln">central1 \
  </span><span class="pun">--</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">output_path </span><span class="str">"${GCS_PATH}/training"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">eval_data_paths </span><span class="str">"${GCS_PATH}/preproc/eval*"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">train_data_paths </span><span class="str">"${GCS_PATH}/preproc/train*"</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">label_count </span><span class="lit">5</span></code><button class="button button--copy js-copy-button-13"><i class="fa fa-clipboard"></i></button></pre>
<aside class="warning"><p><strong>Note</strong>: <code>JOB_ID</code> can be arbitrary but you cannot reuse the same one.</p>
</aside>
<h4>Step 2</h4>
<p>In the <strong>Navigation menu</strong> (<img alt="mainmenu.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/QRLlvUpflhvp875q7fi7Mf_iVCqtMcM10Vfn0vwKZ+4=">), click <strong>AI Platform</strong> &gt; <strong>Jobs</strong> on the Cloud Console, find the running job and  navigate to the <strong>Logs</strong> &gt; <strong>View Logs</strong> to see log messages. The training process takes about 10 minutes. After 1000 training steps, you see the messages as below:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">INFO    </span><span class="lit">2016</span><span class="pun">-</span><span class="lit">12</span><span class="pun">-</span><span class="lit">28</span><span class="pln"> </span><span class="lit">14</span><span class="pun">:</span><span class="lit">19</span><span class="pun">:</span><span class="lit">19</span><span class="pln"> </span><span class="pun">+</span><span class="lit">0900</span><span class="pln">       master</span><span class="pun">-</span><span class="pln">replica</span><span class="pun">-</span><span class="lit">0</span><span class="pln">                </span><span class="typ">Eval</span><span class="pun">,</span><span class="pln"> step </span><span class="lit">1000</span><span class="pun">:</span><span class="pln">
INFO    </span><span class="lit">2016</span><span class="pun">-</span><span class="lit">12</span><span class="pun">-</span><span class="lit">28</span><span class="pln"> </span><span class="lit">14</span><span class="pun">:</span><span class="lit">19</span><span class="pun">:</span><span class="lit">19</span><span class="pln"> </span><span class="pun">+</span><span class="lit">0900</span><span class="pln">       master</span><span class="pun">-</span><span class="pln">replica</span><span class="pun">-</span><span class="lit">0</span><span class="pln">                </span><span class="pun">-</span><span class="pln"> on train </span><span class="kwd">set</span><span class="pln"> </span><span class="lit">0.005</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1.000</span><span class="pln">
INFO    </span><span class="lit">2016</span><span class="pun">-</span><span class="lit">12</span><span class="pun">-</span><span class="lit">28</span><span class="pln"> </span><span class="lit">14</span><span class="pun">:</span><span class="lit">19</span><span class="pun">:</span><span class="lit">19</span><span class="pln"> </span><span class="pun">+</span><span class="lit">0900</span><span class="pln">       master</span><span class="pun">-</span><span class="pln">replica</span><span class="pun">-</span><span class="lit">0</span><span class="pln">                </span><span class="pun">--</span><span class="pln"> on </span><span class="kwd">eval</span><span class="pln"> </span><span class="kwd">set</span><span class="pln"> </span><span class="lit">0.248</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.937</span><span class="pln">
INFO    </span><span class="lit">2016</span><span class="pun">-</span><span class="lit">12</span><span class="pun">-</span><span class="lit">28</span><span class="pln"> </span><span class="lit">14</span><span class="pun">:</span><span class="lit">19</span><span class="pun">:</span><span class="lit">20</span><span class="pln"> </span><span class="pun">+</span><span class="lit">0900</span><span class="pln">       master</span><span class="pun">-</span><span class="pln">replica</span><span class="pun">-</span><span class="lit">0</span><span class="pln">                </span><span class="typ">Exporting</span><span class="pln"> prediction graph to gs</span><span class="pun">://&lt;</span><span class="typ">Your</span><span class="pln"> project ID</span><span class="pun">&gt;-</span><span class="pln">flower</span><span class="pun">/&lt;</span><span class="pln">USER</span><span class="pun">&gt;/</span><span class="pln">training</span><span class="pun">/</span><span class="pln">model</span></code><button class="button button--copy js-copy-button-14"><i class="fa fa-clipboard"></i></button></pre>
<p>This means the model achieved 100% accuracy for the training set and 93.7% accuracy for the evaluation set. (The final accuracy may vary in each training.) The last message indicates that the whole model including the feature extraction part is exported so that you can use the model to classify new images without preprocessing them.</p>
<h2 id="step8">Deploy the Trained Model for Predictions</h2>
<p><em>Duration is 10 min</em></p>
<h3>Deploy the Trained Model</h3>
<p>You deploy the exported model to provide a prediction API.</p>
<h4>Step 1</h4>
<p>Create a prediction API with the specified model name.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">MODEL_NAME</span><span class="pun">=</span><span class="pln">flowers
gcloud ai</span><span class="pun">-</span><span class="pln">platform models create $</span><span class="pun">{</span><span class="pln">MODEL_NAME</span><span class="pun">}</span><span class="pln"> </span><span class="pun">--</span><span class="pln">regions</span><span class="pun">=</span><span class="pln">us</span><span class="pun">-</span><span class="pln">central1</span></code><button class="button button--copy js-copy-button-15"><i class="fa fa-clipboard"></i></button></pre>
<aside class="warning"><p><strong>Note</strong>: <code>MODEL_NAME</code> can be arbitrary but you cannot reuse the same one.</p>
</aside>
<h4>Step 2</h4>
<p>Create and set a default version of the model with the specified version name.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">VERSION_NAME</span><span class="pun">=</span><span class="pln">v1
gcloud ai</span><span class="pun">-</span><span class="pln">platform versions create \
  </span><span class="pun">--</span><span class="pln">origin $</span><span class="pun">{</span><span class="pln">GCS_PATH</span><span class="pun">}/</span><span class="pln">training</span><span class="pun">/</span><span class="pln">model</span><span class="pun">/</span><span class="pln"> \
  </span><span class="pun">--</span><span class="pln">model $</span><span class="pun">{</span><span class="pln">MODEL_NAME</span><span class="pun">}</span><span class="pln"> \
  $</span><span class="pun">{</span><span class="pln">VERSION_NAME</span><span class="pun">}</span><span class="pln">
gcloud ai</span><span class="pun">-</span><span class="pln">platform versions </span><span class="kwd">set</span><span class="pun">-</span><span class="pln">default </span><span class="pun">--</span><span class="pln">model $</span><span class="pun">{</span><span class="pln">MODEL_NAME</span><span class="pun">}</span><span class="pln"> $</span><span class="pun">{</span><span class="pln">VERSION_NAME</span><span class="pun">}</span></code><button class="button button--copy js-copy-button-16"><i class="fa fa-clipboard"></i></button></pre>
<aside class="warning"><p><strong>Note</strong>: <code>VERSION_NAME</code> can be arbitrary but you cannot reuse the same one. The last command is not necessary for the first version since it automatically becomes the default. It's here as a good practice to set the default explicitly.</p>
</aside>
<aside class="warning"><p><strong>Important</strong>: It may take a few minutes for the deployed model to become ready. Until it becomes ready, it returns 503 error.</p>
</aside>
<h3>Create a JSON Request File</h3>
<p>Now you can send an image data to get a classification result. First, you need to convert raw image files into a JSON request file.</p>
<h4>Step 3</h4>
<p>Download two sample images.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil cp gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">tulips</span><span class="pun">/</span><span class="lit">4520577328</span><span class="pln">_a94c11e806_n</span><span class="pun">.</span><span class="pln">jpg flower1</span><span class="pun">.</span><span class="pln">jpg
gsutil cp gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">ml</span><span class="pun">-</span><span class="pln">data</span><span class="pun">/</span><span class="pln">img</span><span class="pun">/</span><span class="pln">flower_photos</span><span class="pun">/</span><span class="pln">roses</span><span class="pun">/</span><span class="lit">4504731519</span><span class="pln">_9a260b6607_n</span><span class="pun">.</span><span class="pln">jpg flower2</span><span class="pun">.</span><span class="pln">jpg</span></code><button class="button button--copy js-copy-button-17"><i class="fa fa-clipboard"></i></button></pre>
<h4>Step 4</h4>
<p>Convert the raw images to a single JSON request file.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">python </span><span class="pun">-</span><span class="pln">c </span><span class="str">'import base64, sys, json; \
  img = base64.b64encode(open(sys.argv[1], "rb").read()); \
  print json.dumps({"key":"1", "image_bytes": {"b64": img}})'</span><span class="pln"> \
  flower1</span><span class="pun">.</span><span class="pln">jpg </span><span class="pun">&gt;</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">json
python </span><span class="pun">-</span><span class="pln">c </span><span class="str">'import base64, sys, json; \
  img = base64.b64encode(open(sys.argv[1], "rb").read()); \
  print json.dumps({"key":"2", "image_bytes": {"b64": img}})'</span><span class="pln"> \
  flower2</span><span class="pun">.</span><span class="pln">jpg </span><span class="pun">&gt;&gt;</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">json</span></code><button class="button button--copy js-copy-button-18"><i class="fa fa-clipboard"></i></button></pre>
<p>In this example, the following images are encoded in base64 and stored in a dictionary associated with key values 1 and 2 respectively.</p>
<p><img alt="ac9eb40193038e37.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/o6A+kQ+XrYVpva9EgLmXHDRR1KJ2qQqbSrUZAuF+C+o="> <img alt="cfcce589272dcfd2.png" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/zOzb9vcerJ5JJ0Xb+CfA8fqEs0e8oTK7XkG4DIZemlA="></p>
<h3>Send a Request to the Prediction API</h3>
<h4>Step 5</h4>
<p>Use the gcloud command to send a request.</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gcloud ai</span><span class="pun">-</span><span class="pln">platform predict </span><span class="pun">--</span><span class="pln">model $</span><span class="pun">{</span><span class="pln">MODEL_NAME</span><span class="pun">}</span><span class="pln"> </span><span class="pun">--</span><span class="pln">json</span><span class="pun">-</span><span class="pln">instances request</span><span class="pun">.</span><span class="pln">json</span></code><button class="button button--copy js-copy-button-19"><i class="fa fa-clipboard"></i></button></pre>
<p>The command returns the prediction result as below:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">KEY  PREDICTION  SCORES
</span><span class="lit">1</span><span class="pln">    </span><span class="lit">4</span><span class="pln">           </span><span class="pun">[</span><span class="lit">1.5868581115796587e-08</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5.666522540082042e-08</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3.1425850011146395e-06</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3.0022348496139273e-10</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.9999967813491821</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8.086380454130904e-09</span><span class="pun">]</span><span class="pln">
</span><span class="lit">2</span><span class="pln">    </span><span class="lit">3</span><span class="pln">           </span><span class="pun">[</span><span class="lit">0.00016239925753325224</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.007603001315146685</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2902684807777405</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.6873179078102112</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.01457294262945652</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7.533563621109352e-05</span><span class="pun">]</span></code><button class="button button--copy js-copy-button-20"><i class="fa fa-clipboard"></i></button></pre>
<p>The returned message shows the key value, prediction and scores. You can use the key value to associate the result with the input image. The prediction is shown in the internal ID as explained in Learn the Dataset section. 4 and 3 correspond to tulips and sunflowers respectively. So the prediction for the second image is incorrect in this example.</p>
<p>You can see more details in scores which show the estimated probabilities for each category. For the first image, the score for ID 4 is almost 1.0. On the other hand, for the second image, the score for ID 3 (sunflowers) is about 0.69 whereas the score for ID 2 (roses) is about 0.29. Compared to the first image, you can see that the prediction for the second image is more uncertain.</p>
<h2 id="step9">Conclusion</h2>
<p><em>Duration is 1 min</em></p>
<h3>What we've covered</h3>
<ul>
<li>How a transfer learning works</li>
<li>How to use Cloud Dataflow for a batch processing of image data</li>
<li>How to use Cloud AI Platform to train a classification model</li>
<li>How to use Cloud AI Platform to provide a prediction API service</li>
</ul>
<h2 id="step10">End your lab</h2>
<p>When you have completed your lab, click <strong>End Lab</strong>. Qwiklabs removes the resources youâ€™ve used and cleans the account for you.</p>
<p>You will be given an opportunity to rate the lab experience. Select the applicable number of stars, type a comment, and then click <strong>Submit</strong>.</p>
<p>The number of stars indicates the following:</p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
<p>You can close the dialog box if you don't want to provide feedback.</p>
<p>For feedback, suggestions, or corrections, please use the <strong>Support</strong> tab.</p>

<p>Manual last Updated: August 06, 2019</p>
<p>Lab Last Tested: August 06, 2019</p>
<p>Â©2019 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
<div class="js-lab-content-outline lab-content__outline is-stuck">
<a href="https://googlecoursera.qwiklabs.com/focuses/35232#step1" class="">Overview</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step2" class="">Introduction</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step3" class="">Setup</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step4" class="">Requirements</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step5" class="">Learn the Dataset</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step6" class="is-active">Preprocess Images with Cloud Dataflow</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step7">Train the Model with Cloud AI Platform</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step8">Deploy the Trained Model for Predictions</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step9">Conclusion</a><a href="https://googlecoursera.qwiklabs.com/focuses/35232#step10">End your lab</a>
</div>
</div>

</div>


</div>
</div>
<div class="lab-introduction js-lab-introduction is-hidden">
<div class="lab-introduction__inner">
<h1 class="headline-1">Welcome to Your First Lab!</h1>
<ql-icon-button class="js-skip-button">close</ql-icon-button>
<div class="lab-introduction__video">
<iframe allow="autoplay; encrypted-media" allowfullscreen="" frameborder="0" id="lab-introduction" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/yF7EDXKTmoQ.html"></iframe>
</div>
<a class="js-skip-button button button--outline">Skip this video</a>
</div>
</div>



</div>
</main>
<div class="modal fade" id="lab-details-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<div class="modal-body">
<p class="l-mbm">
In this lab, you carry out a transfer learning example based on Inception-v3 image recognition neural network. 
</p>
<p class="small-label l-mbs">
<strong>
Duration:
</strong>
0m setup
Â·
120m access
Â·
120m completion
</p>
<p class="small-label l-mbs">
<span><strong>Levels: </strong>introductory</span>
</p>
<p class="small-label">
<strong>
Permalink:
</strong>
<a href="https://googlecoursera.qwiklabs.com/catalog_lab/1965">https://googlecoursera.qwiklabs.com/catalog_lab/1965</a>
</p>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Got It
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
</div>


</div>
</div>
<iframe class="l-ie-iframe-fix" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource(1).html"></iframe>
</div>
<div class="modal fade" id="lab-review-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<form class="simple_form js-lab-review-form" id="new_lab_review" action="https://googlecoursera.qwiklabs.com/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="âœ“"><div class="modal-body">
<p class="label">
How satisfied are you with this lab?*
</p>
<div class="rateit js-rateit" data-rateit-max="5" data-rateit-min="0" data-rateit-resetable="false" data-rateit-step="1" data-rateit-value="0"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 0px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>
<div class="l-mtm">

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="1344779" name="lab_review[user_id]" id="lab_review_user_id"></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" value="4490" name="lab_review[classroom_id]" id="lab_review_classroom_id"></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="1965" name="lab_review[lab_id]" id="lab_review_lab_id"></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" value="35232" name="lab_review[focus_id]" id="lab_review_focus_id"></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating"></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment"></textarea></div></div>
</div>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Cancel
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<input type="submit" name="commit" value="Submit" disabled="disabled" class="btn mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--primary" id="submit" data-disabled="false" data-disable-with="Submit" data-upgraded=",MaterialButton,MaterialRipple"><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></input>
</div>
</form>

</div>
</div>
<iframe class="l-ie-iframe-fix" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource(2).html"></iframe>
</div>

<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    initLabContent( );
  ql.labOutline.links.init();
  ql.labOutline.layout.init();
  initLabReviewModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press âŒ˜-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>
<style>
  .mdl-layout__container {
    position: static
  }
</style>


<iframe data-product="web_widget" title="No content" tabindex="-1" aria-hidden="true" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource(3).html" style="width: 0px; height: 0px; border: 0px; position: absolute; top: -9999px;"></iframe><div><iframe title="Opens a widget where you can chat to one of our agents" id="launcher" tabindex="0" class="zEWidget-launcher zEWidget-launcher--active" style="border: none; background: transparent; z-index: 999998; transform: translateZ(0px); position: fixed; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; opacity: 1; height: 50px; max-height: 551px; min-height: 50px; margin: 10px 20px; right: 0px; bottom: 0px; width: 113px;width: 113px;width: 113px;" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource(4).html"></iframe></div><div><iframe title="Find more information here" id="webWidget" tabindex="-1" class="zEWidget-webWidget " style="border: none; background: transparent; z-index: 999999; transform: translateZ(0px); position: fixed; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; opacity: 0; width: 357px; height: 100%; max-height: 565px; min-height: 150px; margin-left: 8px; margin-right: 8px; top: -9999px; visibility: hidden;" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/saved_resource(5).html"></iframe></div><div id="drift-widget-container" style="position: absolute; z-index: 2147483647;"><iframe id="drift-widget" src="./Image Classification Transfer Learning with Inception v3 _ Qwiklabs_files/index.html" title="Drift Messenger" role="complementary" class="drift-widget-hidden" style="border: none; display: block; height: 0px !important; width: 0px !important; position: fixed; top: auto; left: auto; bottom: 0px; right: 0px; visibility: hidden; z-index: 2147483647; max-height: 100vh; max-width: 100vw; transition: none 0s ease 0s; background: none transparent; opacity: 1; pointer-events: auto; touch-action: auto;"></iframe></div></body></html>